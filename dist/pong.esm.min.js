class Rectangle{constructor(t=0,h=0,i=1,s=1,e=100,l=0){this.x=t,this.y=h,this.width=i,this.height=s,this.speed=e,this.angle=l}get left(){return this.x-this.width/2}get right(){return this.x+this.width/2}get top(){return this.y-this.height/2}get bottom(){return this.y+this.height/2}set top(t){this.y=t+this.height/2}set bottom(t){this.y=t-this.height/2}set left(t){this.x=t+this.width/2}set right(t){this.x=t-this.width/2}}class Paddle extends Rectangle{constructor(t,h,i=1,s=1,e=100){super(t,h,i,s,e),this.direction=0}up(){this.direction=-1}down(){this.direction=1}release(){this.direction=0}update(t){this.y+=this.direction*this.speed*t}}class Ball extends Rectangle{constructor(t,h,i,s,e,l){super(t,h,i,s,e,l)}update(t=1){this.x+=this.speed*Math.cos(this.angle)*t,this.y+=this.speed*Math.sin(this.angle)*-1*t}}class Pong{constructor({width:t=400,height:h=400,winningScore:i=5,scoreA:s=0,scoreB:e=0,paddleA:l=new Paddle(t/20,h/2,t/100,h/4,h),paddleB:d=new Paddle(t-t/20,h/2,t/100,h/4,h),ball:a=new Ball(t/2,h/2,t/100,t/100,400,0)}={}){this.width=t,this.height=h,this.winningScore=i,this.scoreA=s,this.scoreB=e,this.paddleA=l,this.paddleB=d,this.ball=a,this.endOfSet=!1,this.endOfMatch=!1}update(t=1){this.paddleA.update(t),this.paddleB.update(t),this.contrainPaddles(),this.endOfMatch||(this.ball.update(t),this.resolveEdgeCollision(),this.resolvePaddleCollision(),this.checkEndOfSet())}contrainPaddles(){this.paddleA.top<0&&(this.paddleA.top=0),this.paddleA.bottom>this.height&&(this.paddleA.bottom=this.height),this.paddleB.top<0&&(this.paddleB.top=0),this.paddleB.bottom>this.height&&(this.paddleB.bottom=this.height)}resolveEdgeCollision(){this.ball.top<0&&(this.ball.top=0,this.ball.angle*=-1),this.ball.bottom>this.height&&(this.ball.bottom=this.height,this.ball.angle*=-1)}resolvePaddleCollision(){if(!this.endOfSet)if(this.endOfSet=!1,(this.ball.left<this.paddleA.right||this.ball.right>this.paddleB.left)&&(this.endOfSet=!0),this.ball.left<this.paddleA.right&&this.ball.bottom>this.paddleA.top&&this.ball.top<this.paddleA.bottom){this.ball.left=this.paddleA.right;let t=(this.paddleA.bottom+this.ball.height-this.ball.bottom)/(this.paddleA.height+this.ball.height);this.ball.angle=Math.PI/2*t-Math.PI/4,this.endOfSet=!1}else if(this.ball.right>this.paddleB.left&&this.ball.bottom>this.paddleB.top&&this.ball.top<this.paddleB.bottom){this.ball.right=this.paddleB.left;let t=(this.paddleB.bottom+this.ball.height-this.ball.bottom)/(this.paddleB.height+this.ball.height);this.ball.angle=-1*(Math.PI/2*t-Math.PI/4)+Math.PI,this.endOfSet=!1}}scored(t){"A"==t&&this.scoreA++,"B"==t&&this.scoreB++,(this.scoreA>=this.winningScore||this.scoreB>=this.winningScore)&&(this.endOfMatch=!0)}checkEndOfSet(){this.endOfSet&&(this.ball.right<0?this.scored("B"):this.ball.left>this.width&&this.scored("A"),(this.ball.right<0||this.ball.left>this.width)&&this.resetSet())}resetSet(){let t=Math.random()*(Math.PI/4);t*=Math.random()>.5?1:-1,t+=Math.random()>.5?0:Math.PI,this.ball=new Ball(this.width/2,this.height/2,this.width/100,this.width/100,400,t),this.endOfSet=!1}resetMatch(){this.endOfMatch=!1,this.scoreA=0,this.scoreB=0,this.resetSet()}}export default Pong;
